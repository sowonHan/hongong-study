<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7-2절 입력 양식1</title>
    <script>
      // 글자 입력 양식 (1) : input 요소

      document.addEventListener("DOMContentLoaded", () => {
        const unit = document.querySelector("input.unit");
        const button = document.querySelector("button");
        const p_unit = document.querySelector("p.unit_result");

        button.addEventListener("click", () => {
          // input의 value 속성값은 string이기 때문에 숫자로 변환시키는 것.
          const inch = Number(unit.value);

          if (isNaN(inch)) {
            p_unit.textContent = "숫자를 입력해주세요.";
            return;
          }
          // 숫자가 아닐 경우 바로 리턴시키는 코드. return은 함수 실행을 종료하고 'return expression' 형태로 주어진 값이 있다면 해당 값을 함수 호출 지점에 반환하는 키워드인데, 반환할 값을 생략할 경우에는 함수만 종료시키고 값에는 undefined를 대신 반환한다. else를 사용해도 되지만 이쪽이 더 코드가 간결해져서 자주 쓰인다. '조기 리턴'이라고 따로 이름이 있을 만큼 자주 쓰이는 패턴!!

          const cm = inch * 2.54;
          p_unit.textContent = `${cm} cm`;
        });

        const email = document.querySelector("input.email");
        const p_email = document.querySelector("p.email_result");

        const isEmail = (value) => {
          // 무조건 앞 부분에는 안 와서 적당히 양수라는 뜻으로 1을 쓴 건가...?
          return value.indexOf("@") > 1 && value.split("@")[1].indexOf(".") > 1;
        };
        // 올바른 형식의 이메일 주소인지 검사하는 함수. 골뱅이를 가지고 있고 && 골뱅이 뒤에 온점이 있는지 확인해서 둘 다 있으면 true, 둘 중 하나라도 없으면 false로 리턴시킨다.

        email.addEventListener("keyup", (event) => {
          const value = event.currentTarget.value;

          if (isEmail(value)) {
            p_email.style.color = "green";
            p_email.textContent = `이메일 형식입니다. : ${value}`;
          } else {
            p_email.style.color = "red";
            p_email.textContent = `이메일 형식이 아닙니다. : ${value}`;
          }
        });
      });

      // ※ 원래 글자 입력 양식은 change 이벤트를 많이 사용한다. 입력 양식을 선택(focus)해서 글자를 입력하고, 선택을 해제(blur)할 때 글자 입력 양식에 change 이벤트가 발생한다. (입력하는 중에는 change 이벤트가 발생하지 않는다.) 2절의 예시는 값을 입력할 때 실시간으로 결과를 보고자 keyup 이벤트를 사용했다.
    </script>
  </head>
  <body>
    <input type="text" class="unit" /> inch<br />
    <button>계산</button>
    <p class="unit_result"></p>
    <br />
    <hr />
    <br />
    <input type="text" class="email" />
    <p class="email_result"></p>
  </body>
</html>
